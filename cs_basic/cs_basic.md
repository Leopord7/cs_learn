## IO

### epoll poll select

- select通过遍历找到就绪的文件描述符，监视的描述符数量也有限制
- 采用链表实现，没有最大数量限制
- epoll给fd指定回调函数，当描述符就绪后会被加入队列中并执行回调函数，被动触发，不需要轮询

### CPU密集型 IO密集型





## 计网

### ARQ协议

是在有噪声信道中的单工协议

#### 停等式

- 接收方通过校验和机制检测帧是否出错
- 确认帧超时或丢失时进行超时重传

#### 回退n帧

- 在检测到发送出错后重传出错开始的n个报文

#### 连续式

- 一次发送一组帧不需要确认

#### 选择重传

- 只重传错误帧

### TCP三次握手

- 客户端：SYN=1 SEQ = x   进入SYN-SENT
- 服务端：SYN=1 SEQ = y ACK = 1 ack=x+1   进入SYN-RCVD
- 客户端：ACK=1 SEQ = x + 1 ack = y + 1 进入ESTABLISHED(另一边也进)

#### 三次握手的原因

防止失效的用户请求(延迟的等)在服务端积累，造成较大的资源占用

#### 安全问题：SYN FLOODING 攻击

攻击者大量发送SYN报文，但不对SYN-ACK报文进行回应，使得服务器资源空间繁忙

### TCP四次挥手

- 客户端：FIN=1 SEQ = u 进入FIN_WAIT_1
- 服务端：ACK=1 SEQ = v ack = u + 1 进入CLOSE_WAIT（另一边进入FIN_WAIT_2)
- 服务端：FIN=1 SEQ = w ACK = 1 ack = u + 1 进入LAST_ACK（另一边进入TIME_WAIT)
- 客户端：ACK=1 SEQ = u + 1 ack = w + 1（两边进入CLOSED)

![image-20200926155056119](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\image-20200926155056119.png)

#### 客户端等待2MSL原因

使得本连接内的全部报文都发送完毕，不会影响之后的连接

### TCP流量控制

- 滑动窗口机制：报头中存在窗口大小字段，发送方通过读得接收窗口大小使得发送窗口不大于接收窗口

### TCP拥塞控制

- 慢启动：先设置拥塞窗口为1，之后每收到一个报文确认都增加1
- 拥塞避免：在慢启动使得窗口超过慢启动门限之后，每一个RTT使窗口增加1
- 快重传：收到多个重复确认后重传报文
- 快恢复：收到多个重复确认后使慢启动门限变为拥塞窗口大小一半，并启动拥塞避免

### UDP TCP

- 不可靠的，面向报文的多对多的传输协议
- 可靠的，建立在连接上的面向字节流的点对点传输协议

### HTTP

是基于TCP协议的应用层的超文本传输协议，是面向事务且无状态的

### HTTPS

在HTTP的基础上加上SSL加密传输协议来增加安全性

- 双方协商加密算法
- 服务端将证书发给客户端
- 用CA发布的公钥对证书进行验证，成功后生成对称密钥，并用服务端的公钥进行加密
- 服务端用私钥进行非对称解密，得到客户端密钥，之后都用这个密钥对数据进行加解密

### HTTP与HTTPS区别

- 后者需要申请证书
- 前者明文传输，后者通过ssl对数据及逆行加密传输
- 传输端口号不同

### 数字证书

由可信任第三方CA进行证书签发与管理。CA在签发证书的时候先审核申请者的身份，之后便为其分配一个公钥。其它用户可以用这个公钥确认这个证书是否有效。

签名：CA生成证书时用私钥对信息摘要和服务端的公钥等进行加密生成数字签名。

### HTTP不同版本的区别

- 0.9版本：仅支持GET请求，不支持请求头，仅发送文本
- 1.0版本：支持GET,POST,HEAD；可以传输各类文件；默认短链接，数据发送完毕后断开
- 1.1版本：默认长链接，断点续传（从请求参数上实现）
- 2.0版本：基于二进制解析，效率高且准确；支持多路复用，并发处理多个请求；对header进行压缩，加快传输；服务器主动推送

### HTTP状态码

- 100：继续
- 200：正常
- 301：永久移动
- 302：临时移动
- 401：未授权
- 403：拒绝访问
- 404：资源不存在
- 500：网络错误

### POST GET

#### 使用上的区别

- 传参上GET会在URL中而POST会在BODY中
- GET传输的数据受URL长度限制，POST只受配置或内存限制
- GET因为参数在地址栏可见所以相对不安全

#### 深层区别

- GET用于信息获取，应该是安全的幂等的，可缓存
- POST产生更新，不可缓存



## 操作系统

### 虚拟内存 物理内存



### 程序运行时空间



### 进程 线程 

- 进程是系统进行资源调度和分配的一个独立单位
- 线程是进程中的一个实体，是CPU调度的基本单位，和其他同进程的线程共享资源

### 僵尸进程



### Linux内存模型

段页式

#### 页式分配

虚拟空间按页大小分为虚页，物理内存按页大小分为页框，根据作业大小将虚页装入页框，以页表记录分配情况

#### 段式分配

将作业按逻辑分为数据段和程序段等部分进行存储

### CPU调度算法

#### 批处理系统

- 先来先服务：FCFS
- 最短作业优先：SJF
- 最短剩余时间优先：SRTF
- 最高响应比优先：HRRF

#### 交互系统

- 时间片轮转算法
- 优先级算法

### 银行家算法

一种死锁避免的算法。按指定的策略分配资源或者直接推迟分配。

#### 数据结构

- 可用资源向量
- 最大需求矩阵
- 分配矩阵
- 需求矩阵

#### 算法过程

- 找一个需要资源小于可分配资源的任务，找不到则不安全
- 找到后假设该任务已完成并回收已分配的资源
- 若都完成则安全；若没完成回到第一项

### 跳表



### 缺页中断

在请求分页系统中，可以通过查询页表中的状态位来确定所要访问的页面是否存在于内存中。每当所要访问的页面不在内存时，会产生一次缺页中断，此时操作系统会根据页表中的外存地址在外存中找到所缺的一页，将其调入内存。 
　　缺页本身是一种中断，与一般的中断一样，需要经过4个处理步骤： 

  　　1. 保护CPU现场 
  　　2. 分析中断原因 
  　　3. 转入缺页中断处理程序进行处理 
  　　4. 恢复CPU现场，继续执行 

## Linux常用命令行





## 数据库

### 三大范式

- 第一范式：关系中的每一个分量必须是原子的，不可再分
- 第二范式：第一范式基础上，每个非主属性完全依赖于码
- 第三范式：第二范式基础上，不存在非主属性对码的传递依赖

### 索引

> 是帮助MySql高效获取数据的**数据结构**

#### 分类

- 主键索引
	- 特殊的唯一索引，通过指定的主键来创建
	- 标识记录的唯一性

- 唯一索引
	- 标识的数据不能重复
	- 可以创建多个
	- 允许为NULL
- 常规索引
	- 基本的索引
	- 可以为NULL
- 全文索引
	- 搜索引擎常用技术
- 辅助索引（二级索引）

#### 索引实现

- B+树
- 哈希索引：只能用于对等比较

#### B+树与B树与红黑树与AVL树比较

- B+树对于B树：非叶结点只存索引，降低了树的高度；数据只在叶结点，更稳定；顺序指针，更适合范围查询
- AVL树和红黑树：树的深度会相当大，磁盘IO频繁降低速度。

#### 原则

- 适合WHERE子句中出现的列
- 基数小的列不需要建立
- 不要过度建立索引

### 两种数据库引擎

|          | MyISAM                                         | InooDB         |
| -------- | ---------------------------------------------- | -------------- |
| 文件     | 数据索引分开存储 ：.MYD .MYI                   | 集中存储：.ibd |
| 事务     | 不支持事务                                     | 支持事务       |
| 锁       | 支持表级锁                                     | 支持行级锁     |
| 外键约束 | 不支持外键                                     | 支持外键       |
| 索引     | 非聚簇索引（B+树）                             | 聚簇索引(B+树) |
| 指令     | select更快，内部维护了一个计数器，可以直接调取 | 插删改更快     |

#### 索引区别具体叙述

- MyISAM

	- 非聚簇索引，叶子结点保存的是对应记录的指针，可以没有主键

	- 辅助索引和主键索引区别不大

- InnoDB

	- 聚簇索引，主键和行记录存储在一起，叶子结点存储，只有一个。
	- 辅助索引的叶子结点记录主键的值

### 事务

用户定义的一个数据库操作序列并且不可分割

#### 原子性

同一个事务中的操作序列不可分割

#### 一致性

事务前后的数据完整性要保持一致

#### 持久性

事务提交后的结果不会受其它因素改变

#### 隔离性

并发的事务间互不影响

### 隔离产生问题

#### 脏读

一个事务读取了另一个事务未提交的数据

#### 不可重复读

一个事务内多次读取同一数据的结果不同

#### 幻读

一个事务内按相同的方式读取一段记录发现记录增加或减少

### 隔离级别

| 名称                                         | 意义                                                         |
| -------------------------------------------- | ------------------------------------------------------------ |
| 读未提交(read uncommitted)                   | 允许读未提交的数据，三种错误都可能发生                       |
| 读已提交(read committed)                     | 允许读已经提交的数据，解决脏读，后两种错误仍可能发生         |
| 可重复读(repeated-read)  (**mysql默认级别**) | 对同一字段多次读取的结果一致，除非被本事务修改，仍有可能幻读 |
| 可串行化                                     | 最高级别，所有事物依次逐个执行                               |

#### MVCC机制

- 概述：是一种通过多版本控制提高并发的技术，使得事务之间只有写写需要阻塞。
- InnoDB中的实现：
	- 隐藏字段：每一条记录有两个起作用的隐藏字段：最新修改的事务ID，回滚指针
	- Undolog：版本链，以之前说的ID大小为顺序，顺着这条链可以回溯版本
	- ReadView：当前事务执行第一个select时创建的快照，包含不该被本事务看到的其它活跃事务的ID有序列表
	- 过程：用当前记录的最新ID和ReadView列表中的ID进行比较，判断是否需要回滚
		- 如果小于最小的，说明快照生成前最新修改已经完成，修改可见
		- 大于最大的，说明生成快照之后才被修改，回滚
		- 二分查找存不存在，存在说明修改未提交，不可见；反之可见
- 提问：RC和RR下的快照有何不同
	- 生成时机不同，RC每个快照读都生成ReadView；RR第一次快照读才生成ReadView
	- RC由此会读到新的ID，所以是RC。